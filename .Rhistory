library(CoGAPS)
setwd("~/Fertig Lab/cardiac_ATAC_RNA")
acg1 = readRDS("atac_result1.rds") #6pat
acg2 = readRDS("atac_result_2.rds") #5
acg3 = readRDS("atac_result_3.rds") #4
atac_matrix = readRDS("atac_count_matrix.rds")
rcg1 = readRDS("rna_result_1.rds") #5
rcg2 = readRDS("rna_result_2.rds") #4
rcg3 = readRDS("rna_result_3.rds") #6
rna_matrix = readRDS("fully_subset_matched_RNA")
library(ATACCoGAPS)
cgapsPlot(rcg1, as.factor(colnames(rna_matrix))) #first section of is1.e8.5 was one run, isl1.e9.5 also is composed of two runs, second section of isl1.e8.5 another; reasonable to expect that batch effects account for some of these patterns
#making atac cellnames usable for grouping
atac_cellnames = colnames(atac_matrix)
library(stringr)
atac_cellIDs = c()
for(i in 1:length(atac_cellnames)){
tmpID = str_sub(atac_cellnames[i], 1, 4)
atac_cellIDs = c(atac_cellIDs, tmpID)
}
?heatmapPa
?heatmapPatternMarkers
heatmapPatternMarkers(acg1, atac_matrix, as.factor(atac_cellIDs), 50)
?heatmapPatternMatrix
heatmapPatternMatrix(acg1, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg1, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg2, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg2, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg3, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg3, as.factor(atac_cellIDs))
heatmapPatternMatrix(acg1, as.factor(atac_cellIDs), col = colorRampPalette(c("lightgray", "blue"))(n=9))
heatmapPatternMatrix(acg1, as.factor(atac_cellIDs), col = colorRampPalette(c("lightgray", "blue"))(n=9))
heatmapPatternMatrix(rcg3, as.factor(colnames(rna_matrix)), col = colorRampPalette(c("lightgray", "blue"))(n=9))
devtools::install_github("FertigLab/ATACCoGAPS")
#getting count matrix
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/BuenrostroFinalSubsetData.Rdata?raw=true")
BuenrostroFinalSubsetData[1:5, 1:5]
?CoGAPS::CoGAPS
devtools::document()
?ATACTransferLearning
?dataSubsetBySparsity
setwd("~/Fertig Lab/grnlf_scatac_cogaps")
schepATACPreFilter = readRDS(""tidied_scatac_data_matrix.rds"")
schepATACPreFilter = readRDS("tidied_scatac_data_matrix.rds")
save(schepATACPreFilter, "schepATACPreFilter.Rdata")
save(schepATACPreFilter, file ="schepATACPreFilter.Rdata")
setwd("~/R/ATACCoGAPS")
setwd("~/Fertig Lab/grnlf_scatac_cogaps")
schepUnfilteredPeaks = read.csv("grnlf.chr.loc.info")
schepUnfilteredPeaks = as.vector(regions_list[,2])
schepUnfilteredPeaks = as.vector(schepUnfilteredPeaks[,2])
schepUnfilteredPeaks[1:5]
schepUnfilteredCells = as.character(readRDS("factor_celltypes"))
schepUnfilteredCells[1:5]
save(schepUnfilteredCells, file = "schepUnfilteredCells.Rdata")
save(schepUnfilteredPeaks, file = "schepUnfilteredPeaks.Rdata")
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepATACPreFilter.Rdata?raw=true")
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepUnfilteredCells.Rdata?raw=true")
remis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepUnfilteredPeaks.Rdata?raw=true")
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepATACPreFilter.Rdata?raw=true")
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepUnfilteredCells.Rdata?raw=true")
repmis::source_data("https://github.com/FertigLab/ATACCoGAPS/blob/master/schepUnfilteredPeaks.Rdata?raw=true")
dataSubset = dataSubsetBySparsity(data = schepATACPreFilter, cell_list = schepUnfilteredCells, peak_list = schepUnfilteredPeaks, cell_cut = 0.99, peak_cut = 0.99)
dim(dataSubset$subset_data)
setwd("~/R/ATACCoGAPS")
devtools::document()
?dataSubsetBySparsity
devtools::load_all()
?usethis::use_vignette
